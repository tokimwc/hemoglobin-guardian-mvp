# プロジェクト引き継ぎ書

## 1. 実装済み機能

### 1.1 認証機能
- Firebase Authenticationを使用したメール/パスワード認証
- ログイン/新規登録画面の実装
- エラーハンドリングと日本語エラーメッセージ
- 認証状態に基づいた画面遷移の制御

### 1.2 カメラ/ギャラリー機能
- カメラプレビューの表示と写真撮影
- ギャラリーからの画像選択
- 画像キャプチャ後の解析画面への遷移
- 画像プレビューの表示

### 1.3 ML Kit解析機能
- 画像ラベリング（オブジェクト検出）
- 顔検出機能
- 色解析の基本実装
- 信頼度計算と視覚的表示
- 解析結果の整形表示

### 1.4 画面遷移/ルーティング
- go_routerを使用した画面遷移の実装
- 認証状態に基づいたリダイレクト
- 適切なナビゲーションフロー

## 2. 今後の必要機能 & 改善点

### 2.1 Firestoreへのデータ保存 (最優先)
- 解析結果保存
  - 解析日時、リスクレベル、検出された特徴などをFirestoreに保存
  - ユーザー認証IDと紐づけて、履歴・統計を表示できるように
- Firebaseセキュリティルール
  - 「認証済みユーザーのみ書き込み・読み込み可能」という最低限のルールを設定

### 2.2 高度な画像解析（Vision AI）
- ML Kitからアップグレードか、並行運用（ML Kitで前処理→Vision AIで最終判定など）
- 解析精度が上がると貧血リスク推定や特徴量抽出がより信頼でき、ハッカソンでの技術インパクトが高まる

### 2.3 AIアドバイス生成 (Gemini API)
- 現在のリスクレベル + 過去履歴をもとに、「栄養/食事/生活習慣」アドバイスを自動生成
- プロンプト工夫: リスクが高いユーザーにはより詳しいアドバイス、低いユーザーには予防策などパーソナライズ度合いを高める

### 2.4 UI/UX改善
- 解析画面のインタラクション強化
  - ローディングアニメーション・結果表示アニメーションなど
- 結果一覧/グラフ化
  - 過去履歴の推移をチャート表示
  - ユーザーが変化を一目で把握できるデザイン
- ガイドメッセージ
  - カメラ撮影時に「明るい場所で撮影してください」などのヒント

### 2.5 エラーハンドリング強化
- カメラ/ギャラリー失敗時のFallback UI
- ネットワーク障害 (オフライン時/タイムアウトなど)
- APIエラー (Vision AI/Gemini APIが応答しない場合のメッセージやリトライ機能)

## 3. 技術的な注意点

### 3.1 ML Kit関連
- 現在の実装は基本的な画像解析のみ
- 色解析は仮実装（実際の色解析ロジックが必要）
- 信頼度計算ロジックの改善が必要

### 3.2 認証関連
- 現状はメール/パスワード認証のみ
- パスワードリセット機能は未実装
- ソーシャルログインの追加を検討

### 3.3 パフォーマンス
- 画像の圧縮・最適化が未実装
- キャッシュ戦略の検討が必要
- オフライン対応の実装が必要

## 4. 開発環境

### 4.1 必要なセットアップ
- Flutter SDK 3.27.2以上
- Firebase プロジェクトの設定
- ML Kit依存関係の設定
- 適切な権限設定（カメラ、ストレージ）

### 4.2 ビルド手順
```bash
cd frontend
flutter pub get
flutter build apk --debug  # デバッグビルド
flutter build apk --release  # リリースビルド
``` 